@using Pandacap.Data
@using Pandacap.LowLevel
@using Pandacap.HighLevel
@model NotificationsViewModel
@inject ApplicationInformation appInfo

@{
    ViewData["Title"] = "Notifications";
}

<div class="container mb-3">
    <div class="row">
        <div class="col col-12 col-md-6 col-xl-4 mb-3">
            <h2>
                DeviantArt
            </h2>
        </div>

        <div class="col col-12 col-md-6 col-xl-4 mb-3">
            <h2>
                ActivityPub
            </h2>

            <div class="card mt-3">
                <div class="card-header">
                    Recent inbound activities
                </div>
                <ul class="list-group list-group-flush">
                    @foreach (var activity in Model.RecentActivities)
                    {
                        <li class="list-group-item">
                            <div style="white-space: nowrap; overflow-x: hidden; text-overflow: ellipsis">
                                <strong>@activity.RemoteActivity.ActivityType</strong>
                                from
                                <a href="@activity.RemoteActivity.ActorId">
                                    @(activity.Actor?.PreferredUsername ?? activity.RemoteActivity.ActorId)
                                </a>
                            </div>
                            <span class="small text-muted">
                                (@activity.RemoteActivity.AddedAt.ToString("MMMM d, yyyy h:mm tt"))
                            </span>
                        </li>
                    }
                </ul>
            </div>
        </div>

        <div class="col col-12 col-md-6 col-xl-4 mb-3">
            <h2>
                atproto
            </h2>

            <div class="card mt-3">
                <div class="card-header">
                    Recent notifications
                </div>
                <ul class="list-group list-group-flush">
                    @foreach (var activity in Model.RecentATProtoNotifications)
                    {
                        <li class="list-group-item">
                            <div style="white-space: nowrap; overflow-x: hidden; text-overflow: ellipsis">
                                <strong>@activity.Reason</strong>
                                from
                                <a href="@activity.AuthorUri">@activity.AuthorDisplayName</a>
                            </div>
                            <span class="small text-muted">
                                (@activity.IndexedAt.ToString("MMMM d, yyyy h:mm tt"))
                            </span>
                        </li>
                    }
                    <li class="list-group-item">
                        <a href="https://bsky.app/notifications" target="_blank">
                            View all &raquo;
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>
