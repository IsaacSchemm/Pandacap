@using Pandacap.Data
@using Pandacap.HighLevel
@using Pandacap.Models
@model ATProtoFeed

@{
    IFollow follow = Model;
}

<div>
    <img height="50" src="@follow.IconUrl" alt="" />
    <span style="display: inline-block; vertical-align: top">
        <strong>
            @follow.Username
        </strong>
        <br />
        <a href="@follow.Url">@Model.DID</a>
    </span>
</div>

<ul>
    @foreach (var collection in Model.Collections)
    {
        <li>
            <code>@collection.NSID</code>
            @if (collection.LastSeenCIDs.Count > 0)
            {
                @:(last seen: <code>@collection.LastSeenCIDs[0]</code>)
            }
        </li>
    }
</ul>

<form asp-action="UpdateATProtoFeed" method="post" class="mt-3">
    <input type="hidden" asp-for="DID" />
    <div class="mb-3 form-check">
        <input type="checkbox"
               class="form-check-input"
               asp-for="IncludePostsWithoutImages">
        <label class="form-check-label" asp-for="IncludePostsWithoutImages">
            Include posts that do not contain images
        </label>
    </div>
    <div class="mb-3 form-check">
        <input type="checkbox"
               class="form-check-input"
               asp-for="IncludeReplies">
        <label class="form-check-label" asp-for="IncludeReplies">
            Include replies
        </label>
    </div>
    <div class="mb-3 form-check">
        <input type="checkbox"
               class="form-check-input"
               asp-for="IncludeQuotePosts">
        <label class="form-check-label" asp-for="IncludeQuotePosts">
            Include quote posts
        </label>
    </div>
    <div class="mb-3 form-check">
        <input type="checkbox"
               class="form-check-input"
               asp-for="IgnoreImages">
        <label class="form-check-label" asp-for="IgnoreImages">
            Ignore images (treat all posts as text posts)
        </label>
    </div>
    <hr />
    <button type="submit" class="btn btn-outline-primary">Save changes</button>
</form>

<hr />

<form asp-action="RemoveATProtoFeed">
    <input type="hidden" name="did" value="@Model.DID" />
    <button type="submit" class="btn btn-outline-danger">Unfollow @(follow.Username)</button>
</form>
